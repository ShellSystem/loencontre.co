language: php

php:
  - 5.6


before_script:
  - php SourceBackend/laravel/artisan key:generate # Porque genera error con un Key
  - mysql -e 'create database goodfirm_entregas;'
  - mysql goodfirm_entregas < goodfirm_entregas.sql
  #- mysql -u root -e "CREATE USER 'goodfirm_usuario'@'localhost' IDENTIFIED BY ',eE_qW$Sh5KR';"
  #- mysql -u root -e "GRANT ALL PRIVILEGES ON \`goodfirm_entregas\`.* TO goodfirm_usuario@localhost IDENTIFIED BY ',eE_qW$Sh5KR';"
  #- mysql -u root -e "FLUSH PRIVILEGES;"

script:
- SourceBackend/laravel/vendor/bin/phpunit SourceBackend/laravel/tests/UnitTest
- SourceBackend/laravel/vendor/bin/phpunit SourceBackend/laravel/tests/IntegrationTest


after_success:
  - git config credential.helper "store --file=.git/credentials"
  - echo "https://9855893867059db5dab5e9089bf4350c3376d448:@github.com" > .git/credentials
  - git checkout development
  - git merge travis-integration
  - git add .
  - git commit -m "Prueba de despliegue"
  - git push origin development

